var U=Object.defineProperty;var _=(t,e,i)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var S=(t,e,i)=>(_(t,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function i(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=i(o);fetch(o.href,r)}})();const u=Symbol("canvas");function k(t,e){t.style.transform=`translate(${e.x}px, ${e.y}px)`}const m=(t,e)=>t.querySelector(`[data-key="${e}"]`),h=(t,e,i,n=!1)=>{t==null||t.addEventListener(e,i,{passive:!1,once:n})},b=(t,e,i)=>t==null?void 0:t.removeEventListener(e,i),T=(t,e)=>({id:t.pointerId,pos:J(t),shift:{x:e.data.position.x-t.clientX,y:e.data.position.y-t.clientY}}),J=t=>({x:t.clientX,y:t.clientY}),A=(t,e)=>{const i=document.createElementNS("http://www.w3.org/2000/svg",t);return e&&i&&(i.innerHTML=e),i};function Q(t,e){if(e.getAttribute("data-key")==="outer")return;const n=e.getBoundingClientRect(),o=n.width/2,r=n.x+o,s=n.y+o,c=t.clientX,l=t.clientY,p=Math.sqrt(Math.pow(c-r,2)+Math.pow(l-s,2));return console.log(p,o),p<=o}const g=(t,...e)=>t==null?void 0:t.classList.add(...e),C=(t,e)=>t==null?void 0:t.classList.remove(e);function N(t){let e,i=0;for(const n of t.getElementsByTagName("tspan"))for(const o of D(n.getBBox())){const r=Math.abs(o.x)+Math.abs(o.y);i<r&&(e=o,i=r)}return e}const D=t=>[{x:t.x,y:t.y},{x:t.right,y:t.y},{x:t.x,y:t.bottom},{x:t.right,y:t.bottom}];function L(t,e,i){return i<=t?t:t+Math.ceil((i-t)/e)*e}const ee=(t,...e)=>e.map(i=>m(t,i));function j(t,e){const i=e/2;function n(o){const r=Math.round(o/e)*e;return o-r>0?r+i:r-i}t.x=n(t.x),t.y=n(t.y)}const te=t=>({x:t.clientX,y:t.clientY}),ne=(t,e,i)=>({x:(e-t.position.x)/t.scale,y:(i-t.position.y)/t.scale});function ie(t){var r,s;const e=(r=t[u])==null?void 0:r.data;let i;t.ownerSVGElement&&e&&(i=oe(t.ownerSVGElement,e));function n(){t.style.transform=`matrix(${e==null?void 0:e.scale}, 0, 0, ${e==null?void 0:e.scale},
                                 ${e==null?void 0:e.position.x}, ${e==null?void 0:e.position.y})`,i()}function o(c,l){if(!(c<.25||c>4)&&e){const p=c/(e==null?void 0:e.scale);e.scale=c,e.position.x=p*((e==null?void 0:e.position.x)-l.x)+l.x,e.position.y=p*((e==null?void 0:e.position.y)-l.y)+l.y,n()}}t.ownerSVGElement&&t[u]&&se(t.ownerSVGElement,t[u],o,n),(s=t.ownerSVGElement)==null||s.addEventListener("wheel",c=>{c.preventDefault();const l=c.deltaY||c.deltaX,p=Math.abs(l)<50?.05:.25;e&&o(e.scale+(l<0?p:-p),te(c))})}function oe(t,e){let i;function n(o){i!==o&&(i=o,t.style.backgroundImage=`radial-gradient(rgb(73 80 87 / ${o}) 1px, transparent 0)`)}return n(.7),t.style.backgroundSize=`${e.cell}px ${e.cell}px`,()=>{const o=e.cell*e.scale;e.scale<.5?n(0):e.scale<=.9?n(.3):n(.7),t.style.backgroundSize=`${o}px ${o}px`,t.style.backgroundPosition=`${e.position.x}px ${e.position.y}px`}}function se(t,e,i,n){let o,r;const s=l=>{var f,d,y,x;const p=e.data;p.position.x=l.clientX+((d=(f=o||r)==null?void 0:f.shift)==null?void 0:d.x),p.position.y=l.clientY+((x=(y=o||r)==null?void 0:y.shift)==null?void 0:x.y),n()},c=l=>{(o==null?void 0:o.id)===l.pointerId&&(o=null),(r==null?void 0:r.id)===l.pointerId&&(r=null),!o&&!r&&(b(t,"pointermove",s),b(t,"pointercancel",c),b(t,"pointerup",c))};h(t,"pointerdown",l=>{l.stopPropagation(),l instanceof PointerEvent&&t.setPointerCapture(l.pointerId),o||(h(t,"pointermove",s),h(t,"pointercancel",c),h(t,"pointerup",c)),o||(o=T(l,e)),r||(r=T(l,e))})}class q extends HTMLElement{constructor(){super(...arguments);S(this,"canvas");S(this,"pressedShapeKey",null);S(this,"parentElem",null);S(this,"pointElem",null);S(this,"isNativePointerleaveTriggered",null)}connectedCallback(){const i=this.attachShadow({mode:"closed"});i.innerHTML=re();const n=i.getElementById("menu");n==null||n.querySelectorAll('[data-cmd="shapeAdd"]').forEach(o=>h(o,"pointerdown",this)),h(n,"pointerleave",this),h(n,"pointerup",this),h(n,"pointermove",this)}init(i){this.canvas=i}handleEvent(i){var n;switch(i.type){case"pointerleave":this.isNativePointerleaveTriggered=!0,this.pressedShapeKey!=null&&this.shapeCreate(i);break;case"pointermove":if(!this.isNativePointerleaveTriggered&&document.elementFromPoint(i.clientX,i.clientY)===this.pointElem)return;break;case"pointerdown":this.pressedShapeKey=parseInt((n=i.currentTarget)==null?void 0:n.getAttribute("data-cmd-arg")),this.parentElem=document.elementFromPoint(i.clientX,i.clientY),this.pointElem=this.parentElem,this.isNativePointerleaveTriggered=null;break;case"pointerup":this.pressedShapeKey!=null&&this.shapeCreate(i),this.clean();break}}shapeCreate(i){var o;ne(this.canvas[u].data,i.clientX,i.clientY);const n=this.setShapeSvg(this.canvas[u].data.scale,this.canvas[u].data.position.x,this.canvas[u].data.position.y);if(this.pressedShapeKey!=null){const r=this.pressedShapeKey===0?{s:{data:{dir:"right",position:{x:1,y:0}}},e:{data:{dir:"left",position:{x:-42,y:0}}},position:{x:n==null?void 0:n.centerX,y:n==null?void 0:n.centerY}}:{type:this.pressedShapeKey,position:{x:n==null?void 0:n.centerX,y:n==null?void 0:n.centerY},title:"Title"},s=this.canvas[u].shapeMap(this.canvas)[this.pressedShapeKey].create(r);(o=this.canvas)==null||o.append(s.el)}}setShapeSvg(i,n,o){var c;const r=(c=this.canvas)==null?void 0:c.ownerSVGElement,s=r==null?void 0:r.getBoundingClientRect();if(s){const l=(s==null?void 0:s.left)+(s==null?void 0:s.width)/2,p=(s==null?void 0:s.top)+(s==null?void 0:s.height)/2,f=(l-n)*(1/i),d=(p-o)*(1/i);return{centerX:f,centerY:d}}}clean(){this.pressedShapeKey=null,this.parentElem=null,this.pointElem=null}}customElements.define("ap-menu-shape",q);function re(){return`<style>
			.menu {
				overflow-x: auto;
				padding: 0;
				position: fixed;
				top: 50%;
				left: 5px;
				transform: translateY(-50%);
				box-shadow: 0 0 58px 2px rgba(34, 60, 80, 0.2);
				border-radius: 16px;
				background-color: rgba(255,255,255, .9);
				z-index: 10;
			}

			.content {
				white-space: nowrap;
				display: flex;
				flex-direction: column;
			}

			[data-cmd] {
				cursor: pointer;
			}

			.menu svg { padding: 10px; }
			.stroke {
				stroke: #344767;
				stroke-width: 2px;
				fill: transparent;
			}

			.menu .big {
				width: 62px;
				min-width: 62px;
			}

			</style>
			<div id="menu" class="menu" style="touch-action: none;">
				<div class="content">
					<svg class="stroke" data-cmd="shapeAdd" data-cmd-arg="1" viewBox="0 0 24 24" width="24" height="24">
						<circle r="9" cx="12" cy="12"></circle>
					</svg>
					<svg class="stroke" data-cmd="shapeAdd" data-cmd-arg="4" viewBox="0 0 24 24" width="24" height="24">
						<path d="M2 12 L12 2 L22 12 L12 22 Z" stroke-linejoin="round"></path>
					</svg>
					<svg class="stroke" data-cmd="shapeAdd" data-cmd-arg="2" viewBox="0 0 24 24" width="24" height="24">
						<rect x="2" y="4" width="20" height="16" rx="3" ry="3"></rect>
					</svg>
					<svg data-cmd="shapeAdd" data-cmd-arg="0" viewBox="0 0 24 24" width="24" height="24"><path fill="none" d="M0 0h24v24H0z"/>
						<path d="M13 8v8a3 3 0 0 1-3 3H7.83a3.001 3.001 0 1 1 0-2H10a1 1 0 0 0 1-1V8a3 3 0 0 1 3-3h3V2l5 4-5 4V7h-3a1 1 0 0 0-1 1z" fill="rgba(52,71,103,1)"/>
					</svg>
					<svg data-cmd="shapeAdd" data-cmd-arg="3" viewBox="0 0 24 24" width="24" height="24">
						<path fill="none" d="M0 0h24v24H0z"/><path d="M13 6v15h-2V6H5V4h14v2z" fill="rgba(52,71,103,1)"/>
					</svg>
				</div>
			</div>`}function F(t,e,i,n,o,r,s,c,l){let p=!1,f=!1,d;function y(a){a.stopPropagation(),p?s(a):c(a),$(!0)}function x(a){e.contains(a.target)||($(),l())}function X(a){f&&(!p&&(o(a,d),!f)||(le(n,i.scale,a),p=!0,r(a)))}function Z(){$(),l()}function R(a){a.preventDefault(),a.stopPropagation(),!(a[I]||!a.isPrimary)&&(a[I]=!0,d=a.target,d.setPointerCapture(a.pointerId),h(d,"pointercancel",w=>y(w),!0),h(d,"pointerup",w=>y(w),!0),h(d,"pointermove",X),h(t,"pointerdown",x),h(t,"wheel",Z,!0),f=!0)}h(e,"pointerdown",R);function $(a=!1){b(d,"pointercancel",w=>y(w)),b(d,"pointerup",w=>y(w)),b(d,"pointermove",X),a||b(t,"pointerdown",x),d=null,p=!1,f=!1}return $}function le(t,e,i){t.x+=i.movementX/e,t.y+=i.movementY/e}const I=Symbol("processed");function O(t,e,i){var o;const n=ce(i||"",((o=t.x.baseVal[0])==null?void 0:o.value)??0);t.innerHTML=n.s,t.y.baseVal[0].newValueSpecifiedUnits(t.y.baseVal[0].SVG_LENGTHTYPE_EMS,n.c>0?e-n.c/2:e)}function ce(t,e){let i=0;return{s:t.split(`
`).map((n,o)=>(i=o,`<tspan x=${e} dy="${o===0?.41:1}em" ${n.length===0?'visibiliti="hidden"':""}>${n.length===0?".":de(n).replaceAll(" ","&nbsp;")}</tspan>`)).join(""),c:i}}function de(t){return t.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function pe(t,e,i,n,o){let r=A("foreignObject");const s=document.createElement("textarea"),c=()=>ae(t,r,s,p,l.textAlign);s.value=i||"",s.oninput=function(){O(t,e,s.value),n(s.value),c()},s.onblur=function(){o(s.value)},s.onpointerdown=function(f){f.stopImmediatePropagation()},r.appendChild(s),t==null||t.parentElement.appendChild(r);const l=getComputedStyle(s),p=parseInt(l.paddingLeft)+parseInt(l.borderWidth);return c(),s.focus(),{dispose:()=>{r==null||r.remove(),r=null},draw:c}}function ae(t,e,i,n,o){const r=t.getBBox(),s=r.width+20;e.width.baseVal.value=s+2*n+2,e.x.baseVal.value=r.x-10-(o==="center"?10:o==="right"?20:0),e.height.baseVal.value=r.height+2*n+3,e.y.baseVal.value=r.y-n,i.style.width=`${s}px`,i.style.height=`${r.height}px`}const G=Symbol("shape");function W(t){t[u].selectClear&&t[u].selectClear()}function fe(t,e){t[u].selectClear=e}function Y(t,e,i,n,o){const r=A("g",`${i}
        ${Object.entries(n).map(l=>`<circle data-key="${l[0]}" data-connect="${l[1].dir}"
         class="hovertrack" data-evt-index="2" r="10" cx="0" cy="0"
         style="transform: translate(${l[1].position.x}px, ${l[1].position.y}px)"/>`).join("")}`);j(e.position,t[u].data.cell);const s={el:m(r,"text"),vMid:0};O(s.el,s.vMid,e==null?void 0:e.title);const c=ue(t,r,e,n,s,()=>o(s.el));return{el:r,cons:n,draw:c.draw}}function ue(t,e,i,n,o,r){let s;function c(){s==null||s.dispose(),s=null}function l(f){i.title=f,r()}const p=he(t,e,i,n,()=>{s=pe(o.el,o.vMid,i.title,l,l)},c);return s&&s.draw(),e[G]=function(){p.del(),e.remove()},{draw:()=>{p.drawPosition(),s&&(s==null||s.draw())}}}function he(t,e,i,n,o,r){c(),g(e,"hovertrack");let s=0;function c(){e.style.transform=`translate(${i.position.x}px, ${i.position.y}px)`}function l(){r(),s=0,C(e,"select"),C(e,"highlight")}const p=F(t.ownerSVGElement,e,t[u].data,i.position,(f,d)=>{if(!Q(f,d))return!1;l()},c,()=>{j(i.position,t[u].data.cell),c()},()=>{if(s!==2){if(s===0&&W(t),s===1){s=2,C(e,"select"),g(e,"highlight"),o();return}s=1,fe(t,l),g(e,"select")}},l);return e[G]={drawPosition:c,data:i},{drawPosition:c,del:()=>{l(),p()}}}function ye(t,e){const n=Y(t,e,`
	    <circle data-key="outer" data-evt-no data-evt-index="2" r="72" fill="transparent" stroke-width="0" />
		<circle data-key="main" r="48" fill="#ff6600" stroke="#fff" stroke-width="1" />
		<text data-key="text" x="0" y="0" text-anchor="middle" style="pointer-events: none;" fill="#fff">&nbsp;</text>`,{right:{dir:"right",position:{x:48,y:0}},left:{dir:"left",position:{x:-48,y:0}},bottom:{dir:"bottom",position:{x:0,y:48}},top:{dir:"top",position:{x:0,y:-48}}},r=>{const s=me(r,48,24);s!==e.r&&(e.r=s,o())});function o(){n.cons.right.position.x=e.r,n.cons.left.position.x=e.r&&-e.r,n.cons.bottom.position.y=e.r,n.cons.top.position.y=e.r&&-e.r;for(const r in n.cons)k(m(n.el,r),n.cons[r].position);B(n.el,"outer",e.r&&e.r+24),B(n.el,"main",e.r),n.draw()}return n.draw(),n}function B(t,e,i){m(t,e).r.baseVal.value=i}function me(t,e,i){const n=N(t);return L(e,i,Math.sqrt((n==null?void 0:n.x)**2+(n==null?void 0:n.y)**2))}function xe(t,e){const n=Y(t,e,`
		<path data-key="outer" data-evt-no data-evt-index="2" d="M-72 0 L0 -72 L72 0 L0 72 Z" stroke-width="0" fill="transparent" />
		<path data-key="border" d="M-39 0 L0 -39 L39 0 L0 39 Z" stroke-width="20" stroke="#fff"	fill="transparent" stroke-linejoin="round" />
		<path data-key="main" d="M-39 0 L0 -39 L39 0 L0 39 Z" stroke-width="18" stroke-linejoin="round"	stroke="#1D809F" fill="#1D809F" />
		<text data-key="text" x="0" y="0" text-anchor="middle" style="pointer-events: none;" fill="#fff">&nbsp;</text>`,{right:{dir:"right",position:{x:48,y:0}},left:{dir:"left",position:{x:-48,y:0}},bottom:{dir:"bottom",position:{x:0,y:48}},top:{dir:"top",position:{x:0,y:-48}}},r=>{const s=L(96,48,ge(r));s!==e.w&&(e.w=s,o())});g(n.el,"shromb");function o(){const r=v(e.w,0);n.cons.right.position.x=r.r.x,n.cons.left.position.x=r.l.x,n.cons.bottom.position.y=r.b.y,n.cons.top.position.y=r.t.y;for(const c in n.cons)k(m(n.el,c),n.cons[c].position);const s=v(e.w,9);V(n.el,"main",s),V(n.el,"border",s),V(n.el,"outer",v(e.w,-24)),n.draw()}return n}function v(t,e){const i=t/2,n=e-i,o=i-e;return{l:{x:n,y:0},t:{x:0,y:n},r:{x:o,y:0},b:{x:0,y:o}}}function ge(t){const e=N(t);return 2*(Math.abs(e==null?void 0:e.x)+Math.abs(e==null?void 0:e.y))}function V(t,e,i){m(t,e).setAttribute("d",`M${i.l.x} ${i.l.y} L${i.t.x} ${i.t.y} L${i.r.x} ${i.r.y} L${i.b.x} ${i.b.y} Z`)}function E(t,e){const n=Y(t,e,`
		<rect data-key="outer" data-evt-no data-evt-index="2" width="144" height="96" x="-72" y="-48" fill="transparent" stroke="transparent" stroke-width="0" />
		<rect data-key="main" width="96" height="48" x="-48" y="-24" rx="15" ry="15" fill="#1aaee5" stroke="#fff" stroke-width="1" />
		<text data-key="text" y="0" x="0" text-anchor="middle" style="pointer-events: none;" fill="#fff">&nbsp;</text>`,{right:{dir:"right",position:{x:48,y:0}},left:{dir:"left",position:{x:-48,y:0}},bottom:{dir:"bottom",position:{x:0,y:24}},top:{dir:"top",position:{x:0,y:-24}}},r=>{const s=r==null?void 0:r.getBBox(),c=L(96,48,s.width+(e.t?6:0)),l=L(48,48,s.height);((e==null?void 0:e.w)!==c||(e==null?void 0:e.h)!==l)&&(e.w=c,e.h=l,o())});function o(){if(e.w&&e.h){const r=e.w/-2,s=e.h/-2;for(const c in n.cons)k(m(n.el,c),n.cons[c].position);K(n==null?void 0:n.el,"main",e.w,e.h,r,s),K(n==null?void 0:n.el,"outer",e.w&&e.w+48,e.h&&e.h+48,r-24,s-24)}}return g(n.el,e.t?"shtxt":"shrect"),n}function K(t,e,i,n,o,r){const s=m(t,e);s instanceof SVGRectElement&&(s.width.baseVal.value=i,s.height.baseVal.value=n,s.x.baseVal.value=o,s.y.baseVal.value=r)}function we(t,e){const i=A("g",`
		<path data-key="outer" d="M0 0" stroke="transparent" stroke-width="20" fill="none" />
		<path data-key="path" class="path" d="M0 0" stroke="#495057" stroke-width="1.8" fill="none" style="pointer-events: none;" />
		<path data-key="selected" d="M0 0" stroke="transparent" stroke-width="10" fill="none" style="pointer-events: none;" />
	
		<g data-key="start">
		    <circle data-evt-index="1" class="path-end" r="10" stroke-width="0" fill="transparent" />
		    <path class="path" d="M-7 7 l 7 -7 l -7 -7" stroke="#495057" stroke-width="1.8" fill="none" style="pointer-events: none;"></path>
		</g>
		
		<g data-key="end">
		    <circle data-evt-index="1" class="path-end" r="10" stroke-width="0" fill="transparent" />
		    <path class="path" d="M-42 -7 l -7 7 l 7 7" stroke="#495057" stroke-width="1.8" fill="none" style="pointer-events: none;"></path>
		</g>
	`);g(i,"shpath"),e.s.el=m(i,"start"),e.e.el=m(i,"end"),e.styles=e.styles??["arw-s"];const n=ee(i,"path","outer","selected");k(i,e.position);let o,r=0,s=!1,c,l;function p(){s=!1,r=0,C(i,"select")}function f(){const d=Se(e.s.data.position,e.e.data.position);e.e.data.dir=d,e.s.data.dir=$e(d);const y=ke(e);n.forEach(x=>x.setAttribute("d",y)),H(e.e),H(e.s)}return F(t.ownerSVGElement,i,t[u].data,{get x(){return o&&e[o].data.position.x},set x(d){o&&d&&(e[o].data.position.x=d)},get y(){return o&&e[o].data.position.y},set y(d){o&&d&&(e[o].data.position.y=d)}},d=>{if(p(),o=e.e.el.contains(d.target)?"e":e.s.el.contains(d.target)?"s":null,!o){s=!0,c=d.clientX,l=d.clientY;return}},d=>{if(o)f();else if(s){const y=(d.clientX-c)/t[u].data.scale,x=(d.clientY-l)/t[u].data.scale;e.position.x+=y,e.position.y+=x,k(i,e.position),c=d.clientX,l=d.clientY}},()=>{},()=>{if(r!==2){if(r===1){r=2;return}g(i,"select"),r=1}},p),e.styles&&g(i,e.styles),f(),{el:i}}function H(t){t.el.style.transform=`translate(${t.data.position.x}px, ${t.data.position.y}px) rotate(${be(t.data.dir)}deg)`}const be=t=>t==="right"?180:t==="left"?0:t==="bottom"?270:90;function Se(t,e){const i=Math.atan2(e.y-t.y,e.x-t.x);return M(i,-.8,.8)?"left":M(i,.8,2.4)?"top":M(i,2.4,3.2)||M(i,-3.2,-2.4)?"right":"bottom"}function ke(t){let e=Math.hypot(t.s.data.position.x-t.e.data.position.x,t.s.data.position.y-t.e.data.position.y)*.5;e=e>70?70:e<15?15:e;function i(o){return o.dir==="right"||o.dir==="left"?o.dir==="right"?o.position.x+e:o.position.x-e:o.position.x}function n(o){return o.dir==="right"||o.dir==="left"?o.position.y:o.dir==="bottom"?o.position.y+e:o.position.y-e}return`M ${t.s.data.position.x} ${t.s.data.position.y}
			C ${i(t.s.data)} ${n(t.s.data)}, ${i(t.e.data)} ${n(t.e.data)},
														  ${t.e.data.position.x} ${t.e.data.position.y}`}const M=(t,e,i)=>e<=t&&t<=i,$e=t=>t==="left"?"right":t==="right"?"left":t==="top"?"bottom":"top";function Me(t){return{0:{create:e=>we(t,e)},1:{create:e=>ye(t,e)},3:{create:e=>E(t,{...e,t:e.t??!0})},4:{create:e=>xe(t,e)},2:{create:e=>E(t,e)}}}function Ce(t){const e=t.ownerSVGElement;h(e,"pointerdown",()=>{W(t)})}const P=document.getElementById("canvas"),z=document.getElementById("menu-shape");z instanceof q&&z.init(P);P[u]={data:{position:{y:0,x:0},scale:1,cell:24},isTouched:!1,shapeMap:Me};ie(P);Ce(P);
